library "common-lib@main"

echo "Running Dynamic Custom Script Pipeline"
dynamic {
    project = "common-jenkins-lib/customscript"
    serviceAccount = "jenkins-nonprod"
    modules = [ "CUSTOMSCRIPT" ]
    stages = [ development: "development" ]
    scriptConfig = [
        dir: "test/customscripts",
        accountIds: [ development: "959371771112" ],
        build: [
            name: "build.sh",
            container: "snyk",
            params: [ "SomeValue", "{branch}" ]
        ],
        test: [
            name: "test.sh" 
        ],
        deploy: [
            name: "deploy.sh",
            params: [ "{accountId}", "{environment}", "{branch}" ]
        ],
        postDeploy: [
            name: "postDeploy.sh"
        ]
    ]
}